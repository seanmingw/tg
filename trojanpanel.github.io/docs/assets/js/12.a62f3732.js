(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{290:function(t,n,a){"use strict";a.r(n);var s=a(7),e=Object(s.a)({},(function(){var t=this,n=t._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"docker-compose方式安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose方式安装"}},[t._v("#")]),t._v(" Docker Compose方式安装")]),t._v(" "),n("h2",{attrs:{id:"准备"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#准备"}},[t._v("#")]),t._v(" 准备")]),t._v(" "),n("h3",{attrs:{id:"设置伪装网站"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#设置伪装网站"}},[t._v("#")]),t._v(" 设置伪装网站")]),t._v(" "),n("p",[t._v("将静态网站文件上传至伪装网站文件夹："),n("code",[t._v("/tpdata/web/")])]),t._v(" "),n("h3",{attrs:{id:"新建caddy配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#新建caddy配置文件"}},[t._v("#")]),t._v(" 新建Caddy配置文件")]),t._v(" "),n("p",[t._v("文件路径："),n("code",[t._v("/tpdata/caddy/config.json")])]),t._v(" "),n("p",[t._v("Caddy配置举例")]),t._v(" "),n("ol",[n("li",[t._v("acme自动申请和续签")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{\n    "admin": {\n        "disabled": true\n    },\n    "logging": {\n        "logs": {\n            "default": {\n                "writer": {\n                    "output": "file",\n                    "filename": "/tpdata/caddy/logs/error.log"\n                },\n                "level": "ERROR"\n            }\n        }\n    },\n    "storage": {\n        "module": "file_system",\n        "root": "/tpdata/cert/"\n    },\n    "apps": {\n        "http": {\n            "http_port": 80,\n            "servers": {\n                "srv0": {\n                    "listen": [\n                        ":80"\n                    ],\n                    "routes": [\n                        {\n                            "match": [\n                                {\n                                    "host": [\n                                        "${domain}"\n                                    ]\n                                }\n                            ],\n                            "handle": [\n                                {\n                                    "handler": "static_response",\n                                    "headers": {\n                                        "Location": [\n                                            "https://{http.request.host}:8863{http.request.uri}"\n                                        ]\n                                    },\n                                    "status_code": 301\n                                }\n                            ]\n                        }\n                    ]\n                },\n                "srv1": {\n                    "listen": [\n                        ":8863"\n                    ],\n                    "routes": [\n                        {\n                            "handle": [\n                                {\n                                    "handler": "subroute",\n                                    "routes": [\n                                        {\n                                            "match": [\n                                                {\n                                                    "host": [\n                                                        "${domain}"\n                                                    ]\n                                                }\n                                            ],\n                                            "handle": [\n                                                {\n                                                    "handler": "file_server",\n                                                    "root": "/tpdata/web/",\n                                                    "index_names": [\n                                                        "index.html",\n                                                        "index.htm"\n                                                    ]\n                                                }\n                                            ],\n                                            "terminal": true\n                                        }\n                                    ]\n                                }\n                            ]\n                        }\n                    ],\n                    "tls_connection_policies": [\n                        {\n                            "match": {\n                                "sni": [\n                                    "${domain}"\n                                ]\n                            }\n                        }\n                    ],\n                    "automatic_https": {\n                        "disable": true\n                    }\n                }\n            }\n        },\n        "tls": {\n            "certificates": {\n                "automate": [\n                    "${domain}"\n                ]\n            },\n            "automation": {\n                "policies": [\n                    {\n                        "issuers": [\n                            {\n                                "module": "acme",\n                                "email": ""\n                            }\n                        ]\n                    }\n                ]\n            }\n        }\n    }\n}\n')])])]),n("p",[t._v("参数解释")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("${domain}")]),t._v("：你的域名")])]),t._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[t._v("手动设置自定义证书")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('{\n    "admin": {\n        "disabled": true\n    },\n    "logging": {\n        "logs": {\n            "default": {\n                "writer": {\n                    "output": "file",\n                    "filename": "/tpdata/caddy/logs/error.log"\n                },\n                "level": "ERROR"\n            }\n        }\n    },\n    "storage": {\n        "module": "file_system",\n        "root": "/tpdata/cert/"\n    },\n    "apps": {\n        "http": {\n            "http_port": 80,\n            "servers": {\n                "srv0": {\n                    "listen": [\n                        ":80"\n                    ],\n                    "routes": [\n                        {\n                            "match": [\n                                {\n                                    "host": [\n                                        "${domain}"\n                                    ]\n                                }\n                            ],\n                            "handle": [\n                                {\n                                    "handler": "static_response",\n                                    "headers": {\n                                        "Location": [\n                                            "https://{http.request.host}:8863{http.request.uri}"\n                                        ]\n                                    },\n                                    "status_code": 301\n                                }\n                            ]\n                        }\n                    ]\n                },\n                "srv1": {\n                    "listen": [\n                        ":8863"\n                    ],\n                    "routes": [\n                        {\n                            "handle": [\n                                {\n                                    "handler": "subroute",\n                                    "routes": [\n                                        {\n                                            "match": [\n                                                {\n                                                    "host": [\n                                                        "${domain}"\n                                                    ]\n                                                }\n                                            ],\n                                            "handle": [\n                                                {\n                                                    "handler": "file_server",\n                                                    "root": "/tpdata/web/",\n                                                    "index_names": [\n                                                        "index.html",\n                                                        "index.htm"\n                                                    ]\n                                                }\n                                            ],\n                                            "terminal": true\n                                        }\n                                    ]\n                                }\n                            ]\n                        }\n                    ],\n                    "tls_connection_policies": [\n                        {\n                            "match": {\n                                "sni": [\n                                    "${domain}"\n                                ]\n                            }\n                        }\n                    ],\n                    "automatic_https": {\n                        "disable": true\n                    }\n                }\n            }\n        },\n        "tls": {\n            "certificates": {\n                "automate": [\n                    "${domain}"\n                ],\n                "load_files": [\n                    {\n                        "certificate": "/tpdata/cert/certificates/acme-v02.api.letsencrypt.org-directory/${domain}/${domain}.crt",\n                        "key": "/tpdata/cert/certificates/acme-v02.api.letsencrypt.org-directory/${domain}/${domain}.key"\n                    }\n                ]\n            },\n            "automation": {\n                "policies": [\n                    {\n                        "issuers": [\n                            {\n                                "module": "acme",\n                                "email": ""\n                            }\n                        ]\n                    }\n                ]\n            }\n        }\n    }\n}\n')])])]),n("p",[t._v("注意：需要将证书文件上传至证书文件夹："),n("code",[t._v("/tpdata/cert/")]),t._v("，证书文件名称格式为"),n("code",[t._v("${domian}.crt")]),t._v("和"),n("code",[t._v("${domian}.key")]),t._v("。")]),t._v(" "),n("p",[t._v("参数解释")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("${domain}")]),t._v("：你的域名")])]),t._v(" "),n("h3",{attrs:{id:"新建nginx配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#新建nginx配置文件"}},[t._v("#")]),t._v(" 新建Nginx配置文件")]),t._v(" "),n("p",[t._v("文件路径："),n("code",[t._v("/tpdata/trojan-panel-ui/nginx/default.conf")])]),t._v(" "),n("ol",[n("li",[t._v("使用 https")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("server {\n    listen       8888 ssl;\n    server_name  localhost;\n    #强制ssl\n    ssl on;\n    ssl_certificate      /tpdata/cert/${domain}.crt;\n    ssl_certificate_key  /tpdata/cert/${domain}.key;\n    #缓存有效期\n    ssl_session_timeout  5m;\n    #安全链接可选的加密协议\n    ssl_protocols  TLSv1.3;\n    #加密算法\n    ssl_ciphers  ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;\n    #使用服务器端的首选算法\n    ssl_prefer_server_ciphers  on;\n    #access_log  /var/log/nginx/host.access.log  main;\n    location / {\n        root   /tpdata/trojan-panel-ui/;\n        index  index.html index.htm;\n    }\n    location /api {\n        proxy_pass http://127.0.0.1:8081;\n    }\n    #error_page  404              /404.html;\n    #497 http->https\n    error_page  497               https://\\$host:8888\\$request_uri;\n    # redirect server error pages to the static page /50x.html\n    #\n    error_page   500 502 503 504  /50x.html;\n    location = /50x.html {\n        root   /usr/share/nginx/html;\n    }\n}\n")])])]),n("p",[t._v("参数解释")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("${domain}")]),t._v("：你的域名")])]),t._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[t._v("使用 http")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("server {\n    listen       8888;\n    server_name  localhost;\n    location / {\n        root   /tpdata/trojan-panel-ui/;\n        index  index.html index.htm;\n    }\n    error_page  497               http://\\$host:8888\\$request_uri;\n    error_page   500 502 503 504  /50x.html;\n    location = /50x.html {\n        root   /usr/share/nginx/html;\n    }\n}\n")])])]),n("h2",{attrs:{id:"配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置文件"}},[t._v("#")]),t._v(" 配置文件")]),t._v(" "),n("div",{staticClass:"language-yml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-yml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'3'")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("trojan-panel-caddy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" caddy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("2.6.2\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" trojan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("panel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("caddy\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("network_mode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" host\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tpdata/caddy/config.json:/tpdata/caddy/config.json"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tpdata/cert/:/tpdata/cert/certificates/acme-v02.api.letsencrypt.org-directory/${domain}/"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tpdata/web/:/tpdata/web/"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tpdata/caddy/logs/:/tpdata/caddy/logs/"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" caddy run "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("config /tpdata/caddy/config.json\n\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("trojan-panel-mariadb")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mariadb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("10.7.3\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" trojan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("panel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("mariadb\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("network_mode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" host\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MYSQL_DATABASE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" trojan_panel_db\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("MYSQL_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"${mariadb_pas}"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("TZ")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Asia/Shanghai\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("port=9507\n\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("trojan-panel-redis")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" redis"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("6.2.7\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" trojan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("panel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("redis\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("network_mode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" host\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" redis"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("requirepass $"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("redis_pass"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("port 6378\n\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("trojan-panel")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jonssonyan/trojan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("panel\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" trojan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("panel\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("network_mode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" host\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tpdata/web/:/tpdata/trojan-panel/webfile/"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tpdata/trojan-panel/logs/:/tpdata/trojan-panel/logs/"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tpdata/trojan-panel/export:/tpdata/trojan-panel/export"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tpdata/trojan-panel/template:/tpdata/trojan-panel/template"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/etc/localtime:/etc/localtime"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GIN_MODE=release"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mariadb_ip=127.0.0.1"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mariadb_port=9507"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mariadb_user=root"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mariadb_pas=${mariadb_pas}"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"redis_host=127.0.0.1"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"redis_port=6378"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"redis_pass=${redis_pass}"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"server_port=8081"')]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("trojan-panel-ui")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jonssonyan/trojan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("panel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("ui\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" trojan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("panel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("ui\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("network_mode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" host\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tpdata/trojan-panel-ui/nginx/default.conf:/etc/nginx/conf.d/default.conf"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tpdata/cert/:/tpdata/cert/"')]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("trojan-panel-core")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jonssonyan/trojan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("panel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("core\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" trojan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("panel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("core\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("network_mode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" host\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tpdata/trojan-panel-core/bin/xray/config:/tpdata/trojan-panel-core/bin/xray/config"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tpdata/trojan-panel-core/bin/trojango/config:/tpdata/trojan-panel-core/bin/trojango/config"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tpdata/trojan-panel-core/bin/hysteria/config:/tpdata/trojan-panel-core/bin/hysteria/config"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tpdata/trojan-panel-core/bin/naiveproxy/config:/tpdata/trojan-panel-core/bin/naiveproxy/config"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tpdata/trojan-panel-core/logs/:/tpdata/trojan-panel-core/logs/"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tpdata/trojan-panel-core/config/sqlite/:/tpdata/trojan-panel-core/config/sqlite/"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tpdata/cert/:/tpdata/cert/"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tpdata/web/:/tpdata/web/"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/etc/localtime:/etc/localtime"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GIN_MODE=release"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mariadb_ip=127.0.0.1"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mariadb_port=9507"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mariadb_user=root"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mariadb_pas=${mariadb_pas}"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"database=trojan_panel_db"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"account-table=account"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"redis_host=127.0.0.1"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"redis_port=6378"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"redis_pass=${redis_pass}"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"crt_path=/tpdata/cert/${domain}.crt"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"key_path=/tpdata/cert/${domain}.key"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"grpc_port=8100"')]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"server_port=8082"')]),t._v("\n")])])]),n("p",[t._v("参数解释：")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("${mariadb_pas}")]),t._v("：MariaDB 数据库密码")]),t._v(" "),n("li",[n("code",[t._v("${redis_pass}")]),t._v("：Redis 的密码")]),t._v(" "),n("li",[n("code",[t._v("${domain}")]),t._v("：你的域名")])]),t._v(" "),n("h2",{attrs:{id:"部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#部署"}},[t._v("#")]),t._v(" 部署")]),t._v(" "),n("p",[t._v("在Docker Compose配置文件同一级目录下执行")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" compose up\n")])])])])}),[],!1,null,null,null);n.default=e.exports}}]);